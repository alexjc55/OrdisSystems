ПРЯМАЯ МИГРАЦИЯ НА VPS БЕЗ ФАЙЛОВ
================================

Выполнить на VPS сервере командой по одной:

1. Остановить приложение:
pm2 stop edahouse
pm2 delete edahouse

2. Выполнить миграцию прямо в командной строке:

psql -h localhost -U edahouse_usr -d edahouse << 'EOF'
BEGIN;

ALTER TABLE store_settings ADD COLUMN IF NOT EXISTS slider_speed INTEGER DEFAULT 5000;
ALTER TABLE store_settings ADD COLUMN IF NOT EXISTS slider_effect VARCHAR(10) DEFAULT 'fade';

ALTER TABLE store_settings ADD COLUMN IF NOT EXISTS slide1_image VARCHAR(500);
ALTER TABLE store_settings ADD COLUMN IF NOT EXISTS slide1_title VARCHAR(255);
ALTER TABLE store_settings ADD COLUMN IF NOT EXISTS slide1_subtitle TEXT;
ALTER TABLE store_settings ADD COLUMN IF NOT EXISTS slide1_button_text VARCHAR(100);
ALTER TABLE store_settings ADD COLUMN IF NOT EXISTS slide1_button_link VARCHAR(500);
ALTER TABLE store_settings ADD COLUMN IF NOT EXISTS slide1_text_position VARCHAR(20) DEFAULT 'left';

ALTER TABLE store_settings ADD COLUMN IF NOT EXISTS slide2_image VARCHAR(500);
ALTER TABLE store_settings ADD COLUMN IF NOT EXISTS slide2_title VARCHAR(255);
ALTER TABLE store_settings ADD COLUMN IF NOT EXISTS slide2_subtitle TEXT;
ALTER TABLE store_settings ADD COLUMN IF NOT EXISTS slide2_button_text VARCHAR(100);
ALTER TABLE store_settings ADD COLUMN IF NOT EXISTS slide2_button_link VARCHAR(500);
ALTER TABLE store_settings ADD COLUMN IF NOT EXISTS slide2_text_position VARCHAR(20) DEFAULT 'left';

ALTER TABLE store_settings ADD COLUMN IF NOT EXISTS slide3_image VARCHAR(500);
ALTER TABLE store_settings ADD COLUMN IF NOT EXISTS slide3_title VARCHAR(255);
ALTER TABLE store_settings ADD COLUMN IF NOT EXISTS slide3_subtitle TEXT;
ALTER TABLE store_settings ADD COLUMN IF NOT EXISTS slide3_button_text VARCHAR(100);
ALTER TABLE store_settings ADD COLUMN IF NOT EXISTS slide3_button_link VARCHAR(500);
ALTER TABLE store_settings ADD COLUMN IF NOT EXISTS slide3_text_position VARCHAR(20) DEFAULT 'left';

ALTER TABLE store_settings ADD COLUMN IF NOT EXISTS slide4_image VARCHAR(500);
ALTER TABLE store_settings ADD COLUMN IF NOT EXISTS slide4_title VARCHAR(255);
ALTER TABLE store_settings ADD COLUMN IF NOT EXISTS slide4_subtitle TEXT;
ALTER TABLE store_settings ADD COLUMN IF NOT EXISTS slide4_button_text VARCHAR(100);
ALTER TABLE store_settings ADD COLUMN IF NOT EXISTS slide4_button_link VARCHAR(500);
ALTER TABLE store_settings ADD COLUMN IF NOT EXISTS slide4_text_position VARCHAR(20) DEFAULT 'left';

ALTER TABLE store_settings ADD COLUMN IF NOT EXISTS slide5_image VARCHAR(500);
ALTER TABLE store_settings ADD COLUMN IF NOT EXISTS slide5_title VARCHAR(255);
ALTER TABLE store_settings ADD COLUMN IF NOT EXISTS slide5_subtitle TEXT;
ALTER TABLE store_settings ADD COLUMN IF NOT EXISTS slide5_button_text VARCHAR(100);
ALTER TABLE store_settings ADD COLUMN IF NOT EXISTS slide5_button_link VARCHAR(500);
ALTER TABLE store_settings ADD COLUMN IF NOT EXISTS slide5_text_position VARCHAR(20) DEFAULT 'left';

UPDATE store_settings SET 
    slider_autoplay = COALESCE(slider_autoplay, true),
    slider_speed = COALESCE(slider_speed, 5000),
    slider_effect = COALESCE(slider_effect, 'fade'),
    slide1_text_position = COALESCE(slide1_text_position, 'left'),
    slide2_text_position = COALESCE(slide2_text_position, 'left'),
    slide3_text_position = COALESCE(slide3_text_position, 'left'),
    slide4_text_position = COALESCE(slide4_text_position, 'left'),
    slide5_text_position = COALESCE(slide5_text_position, 'left')
WHERE id = 1;

COMMIT;
EOF

3. Проверить что все колонки добавлены (должно показать 33):
psql -h localhost -U edahouse_usr -d edahouse -c "SELECT COUNT(*) FROM information_schema.columns WHERE table_name = 'store_settings' AND (column_name LIKE '%slider%' OR column_name LIKE '%slide%');"

4. Запустить приложение:
pm2 start ecosystem.production.config.cjs

5. Проверить что ошибки исчезли:
pm2 logs edahouse --lines 5

Это выполнит всю миграцию одной командой без использования файлов.