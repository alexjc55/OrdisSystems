# –†–£–ö–û–í–û–î–°–¢–í–û –ü–û –ò–°–ü–†–ê–í–õ–ï–ù–ò–Æ –ë–ê–ó–´ –î–ê–ù–ù–´–• –°–ï–†–í–ï–†–ê

## üéØ –¶–ï–õ–¨
–ò—Å–ø—Ä–∞–≤–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –Ω–∞ VPS —Å–µ—Ä–≤–µ—Ä–µ, —á—Ç–æ–±—ã –æ–Ω–∞ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞–ª–∞ —Ä–∞–±–æ—á–µ–π –≤–µ—Ä—Å–∏–∏ –≤ Replit.

## ‚ùå –ü–†–û–ë–õ–ï–ú–ê
–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è `migrations/add-barcode-system.sql` –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:
- –î–æ–±–∞–≤–ª–µ–Ω—ã –ª–∏—à–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –∏ –ø–æ–ª—è, –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –≤ schema.ts
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç Replit –≤–µ—Ä—Å–∏–∏
- –®—Ç—Ä–∏—Ö-–∫–æ–¥—ã –º–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

## ‚úÖ –†–ï–®–ï–ù–ò–ï 

### –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò–ô –°–ü–û–°–û–ë (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä:
```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤ –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞
git pull origin main
```

2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
```bash
chmod +x scripts/fix-server-database.sh
./scripts/fix-server-database.sh
```

3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
```bash
pm2 restart edahouse
```

### –†–£–ß–ù–û–ô –°–ü–û–°–û–ë

1. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:
```bash
psql $DATABASE_URL
```

2. –í—ã–ø–æ–ª–Ω–∏—Ç–µ SQL –∏–∑ —Ñ–∞–π–ª–∞ `migrations/server-database-fix.sql`

3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
```sql
-- –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å: barcode_fields_in_products=1, barcode_config_fields=6
SELECT 
  (SELECT COUNT(*) FROM information_schema.columns WHERE table_name = 'products' AND column_name LIKE '%barcode%') as barcode_fields_in_products,
  (SELECT COUNT(*) FROM information_schema.columns WHERE table_name = 'store_settings' AND column_name LIKE '%barcode%') as barcode_config_fields;
```

## üîç –ß–¢–û –î–ï–õ–ê–ï–¢ –ú–ò–ì–†–ê–¶–ò–Ø

### –£–¥–∞–ª—è–µ—Ç –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã:
- ‚ùå –¢–∞–±–ª–∏—Ü–∞ `barcode_config` (–Ω–µ –≤ schema.ts)
- ‚ùå –¢–∞–±–ª–∏—Ü–∞ `barcode_scan_log` (–Ω–µ –≤ schema.ts) 
- ‚ùå –ü–æ–ª—è `barcode_en`, `barcode_he`, `barcode_ar` –∏–∑ products
- ‚ùå –ü–æ–ª—è `scanned_weight`, `is_weight_scanned`, `barcode_used` –∏–∑ order_items

### –î–æ–±–∞–≤–ª—è–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã:
- ‚úÖ –ü–æ–ª–µ `products.barcode` (VARCHAR(50))
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —à—Ç—Ä–∏—Ö-–∫–æ–¥–æ–≤ –≤ `store_settings`:
  - `barcode_system_enabled` (BOOLEAN)
  - `barcode_product_code_start` (INTEGER)
  - `barcode_product_code_end` (INTEGER) 
  - `barcode_weight_start` (INTEGER)
  - `barcode_weight_end` (INTEGER)
  - `barcode_weight_unit` (VARCHAR(10))

### –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —Å–∏—Å—Ç–µ–º—É:
- ‚úÖ –í–∫–ª—é—á–∞–µ—Ç —à—Ç—Ä–∏—Ö-–∫–æ–¥—ã –¥–ª—è –∏–∑—Ä–∞–∏–ª—å—Å–∫–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞
- ‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏: –ø–æ–∑–∏—Ü–∏–∏ 2-5 –¥–ª—è –∫–æ–¥–∞ —Ç–æ–≤–∞—Ä–∞, 6-10 –¥–ª—è –≤–µ—Å–∞
- ‚úÖ –î–æ–±–∞–≤–ª—è–µ—Ç —Ç–µ—Å—Ç–æ–≤—ã–π —à—Ç—Ä–∏—Ö-–∫–æ–¥ –¥–ª—è —Ç–æ–≤–∞—Ä–∞ "–ê–±–∂–µ—Ä–∫–∞"

## üéâ –†–ï–ó–£–õ–¨–¢–ê–¢

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏:
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–µ—Ä–≤–µ—Ä–∞ –∏–¥–µ–Ω—Ç–∏—á–Ω–∞ Replit –≤–µ—Ä—Å–∏–∏
- –®—Ç—Ä–∏—Ö-–∫–æ–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –ù–∏–∫–∞–∫–∏—Ö –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ —Å schema.ts
- –°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É

## üÜò –û–¢–ö–ê–¢ (–µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫)

–ï—Å–ª–∏ —Å–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞–ª —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é:
```bash
psql $DATABASE_URL < database_backup_YYYYMMDD_HHMMSS.sql
```

## üìû –ü–û–î–î–ï–†–ñ–ö–ê

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `pm2 logs edahouse`
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ DATABASE_URL –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ PostgreSQL —Å–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω
4. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∑–∞ –ø–æ–º–æ—â—å—é —Å –ª–æ–≥–∞–º–∏ –æ—à–∏–±–æ–∫